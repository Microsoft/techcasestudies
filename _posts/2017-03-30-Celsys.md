---
layout: post
title: "CLIP STUDIO PAINT conversion to Windows UWP App with Desktop Bridge"
author: "Shozo Arai"
author-link: "https://blogs.msdn.microsoft.com/shozoa/"
#author-image: "{{ site.baseurl }}/images/authors/photo.jpg"
date: 2017-03-30
categories: [Desktop Bridge]
color: "blue"
#image: "{{ site.baseurl }}/images/imagename.png" #should be ~350px tall
excerpt: CLIP STUDIO PAINT is the leading paint tool software which supports creating  animation and manga. It is widely-used in animation studios and by individual creators across the world. CLIP STUDIO is preinstalled in Windows (OEM). OEM makers have been asking for a Windows Store version of CLIP STUDIO, and hence there is now an urgent need to respond to this demand. Even if they were considering the development of the Universal Windows Platform (UWP), it was expected that making UWP would take significantly more time and effort to accomplish the development work.
language: English
verticals: "Retail, Consumer Products & Services"
---

![CLIP STUDIO PAINT Public site]({{ site.baseurl }}/images/celsys/clipstudionet.png)
[CLIP STUDIO PAINT](http://www.clipstudio.net/) is the leading paint tool software which supports creating  animation and manga. It is widely-used in animation studios and by individual creators across the world. It is leading paint software for two years in a row, and also supports multiple languages (Japanese, English, French, Chinese, Portuguese, German, Korean).

Core team:
- Yasushi Nakanishi – Senior Developer
- Noriaki Aoyama – Chief Developer
- Tetsuro Shimada – Manager
- Tomoaki Yokotsuka – General Manager
- Shozo Arai – Technical Evangelist, Microsoft Japan
- Shinobu Takahashi – Technical Evangelist, Microsoft Japan
 
## Customer profile ##

[CELSYS, Inc.](https://www.celsys.co.jp/) develops animation and manga production software, and provides mobile comics and e-book content services. Naturally, with material like illustration, manga, and animation, CELSYS develops digital production tools that are used to express new digital content. They provide these tools to creators all over the world. CELSYS also provides viewing environments, distribution support, and services supporting communications for the material developed by content creators. Their goal is to provide comprehensive solutions to support creators in the graphics field.


## Problem statement ##

CLIP STUDIO is preinstalled in Windows (OEM). OEM makers have been asking for a Windows Store version of CLIP STUDIO, and hence there is now an urgent need to respond to this demand. Even if they were considering the development of the Universal Windows Platform (UWP), it was expected that making UWP would take significantly more time and effort to accomplish the development work.
The business challenge was to figure out what form the product should take for Windows store since there is an application that is already being sold as a package. To save time to release to Windows store, they decided to convert their existing Win32 application with Desktop Bridge. 
**There are multiple technical challenges during conversion:**


1. We cannot perform a typical migration because the application has undergone multistage execution. 
2. The installer is highly customized for the application making it impossible to convert the application as is
3. Although the application may be installed to function as a user-created plug-in model, users are unable to run the same functions on the system after the conversion
4. The application behavior may be different when a shell  extension is used (affect uninstallation as well).

**To handle these issues, we took the following steps:**

## Solution, steps, and delivery ##

1. Held Hackfest (intensive technical implementation and coding session) for Desktop Bridge.
2. Discussed issues on running UWP App of CLIP STUDIO PAINT.
3. Published UWP App to Windows Store.

### 1. Hackfest ###
In the Hackfest, the procedure was as follows:
- Conducted a session on how to use Desktop App Converter and Windows SDK Tools.
- Provided a sample of an app to convert.
- In case of issues, discuss and decide on how to solve it.
- As required, provide new sample code of script

<img alt="Hackfest 1" src="{{ site.baseurl }}/images/celsys/Hackfest1.png" width="200"><img alt="Hackfest 2" src="{{ site.baseurl }}/images/celsys/Hackfest2.png" width="200"><img alt="Hackfest 3" src="{{ site.baseurl }}/images/celsys/Hackfest3.png" width="200"> 

### 2. Discuss issues on running UWP App of CLIP STUDIO PAINT. ###
1.	Q&A  
**How to share data between desktop and UWP:**  Provide ways on how to use data sharing methodologies.  
**How to get AppUserModelId:** None, because it is not required in UWP App.
How use external plug-in?  None, as they need to change the plug-in model. 
Can use Google IME on UWP App?   It is a well-known issue of Google IME.  
**How set sales setting on dashboard?** Advised on how to publish the app on Windows Store.

2. **Issue:**  
**how use Windows Runtime API?** with minimum impact to the existing code
We recommended using the win32 dynamic link library. To encapsulate Windows Runtime API code.
We provide the [DLL Sample code](https://github.com/shozoarai/DesktopBridgeSample/tree/master/Samples/WpfAppUsingWinRT).

3. **Countermeasure against casual hacking.**  
In CLIP STUDIO PAINT App, can xopy deploy, then lunch clone executable. We offer specific behavior of process type, UWP App or Desktop App. How to detemine process type? 
[We provided sample code](https://github.com/shozoarai/DesktopBridgeSample/tree/master/Samples/UwpProcessHelper).
 
4. **Issue:**  
**don’t show icon of file extension.**  
<img alt="Hackfest 1" src="{{ site.baseurl }}/images/celsys/FileExtension.png" width="400">  
Our investigated result is “effect of desktop App”, as the app leaves behind registry sessions. Hence, removing it worked well. We provide the document of [How to use the file extension](https://github.com/shozoarai/DesktopBridgeSample/blob/master/Doc/HowToUseFileExtension.md).

5. **Issue:**  
**Effect pri resources of Desktop App Converter v1.0.6 or higher.**  
DAC v1.0.6 require pri resources with changed specifications. We demonstrated how to create pri resources. We provide the document of [How to create pri resources](
https://github.com/shozoarai/DesktopBridgeSample/blob/master/Doc/HowToCreatePriResources.md).


### 3. Published UWP App to Windows Store ###
Special thanks to Kazuki Tsuguma (Microsoft App Consultant), who helped to publish the Windows App. The package is now available on Windows Store.  
<img alt="WindowsStore" src="{{ site.baseurl }}/images/celsys/ClipForApps.png" width="400">

<img alt="App1" src="{{ site.baseurl }}/images/celsys/ClipStudioApp1.png" width="300"><img alt="App2" src="{{ site.baseurl }}/images/celsys/ClipStudioApp2.png" width="300">  
<img alt="App3" src="{{ site.baseurl }}/images/celsys/ClipStudioApp3.png" width="300"><img alt="App4" src="{{ site.baseurl }}/images/celsys/ClipStudioApp4.png" width="300">  
<img alt="App6" src="{{ site.baseurl }}/images/celsys/ClipStudioApp5.png" width="300">


## Opportunities going forward ##

CELSYS now has the app ready for Windows Store. Since they are trying to add Surface Dial functions to the app, the app isn’t open to public yet. As soon as the functions are added, the app will be official released to the Windows Store.  

 
## Conclusion ##

CELSYS developer team successfully converted CLIP STUDIO PAINT app. They are expecting to have broader customer reach with Windows Store, and enhanced usability with additional functions with [Surface Dial](https://www.microsoft.com/surface/en-us/accessories/surface-dial). This section briefly summarizes the technical story with the following details included:


## Additional resources ##

- [CLIP STUDIO PAINT](http://www.clipstudio.net/)
- [Desktop Bridge Sample](https://github.com/shozoarai/DesktopBridgeSample)
